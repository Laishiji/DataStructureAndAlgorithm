# 平衡二叉树性质
1. 若二分搜索树添加的元素本身就是有序的，那么二分搜素树就退化成了单链表。因此我们需要平衡二叉树来避免这种情况发生。
2. **平衡二叉树**：对于任意一个节点，其左子树和右子树的高度差不能超过1。比如：
    ```
                    (4)12
                   /    \
                (3)8    (2)18
                 / \      /
             (2)5  (1)11 17(1)
               /
           (1)4
    ```
   上面这棵二叉树每一个节点的**高度**都标注在括号中，虽然其看起来有些偏斜，但是实际上满足平衡二叉树的定义。
  常见的平衡二叉树有满二叉树、完全二叉树、线段树等。上述的平衡二叉树平衡度都较高，因为它们都满足“对于任意一个**叶子节点**，其左子树和右子树的高度差不超过1”。
3. **平衡因子**：每个节点的平衡因子为其**左右子树的高度差**。任意一个节点的平衡因子绝对值大于1，那么这棵树就不是平衡二叉树。
4. AVL树是最早的**自平衡二分搜索树**。增加和删除元素可能会改变树中某些节点的平衡因子，使其大于1，因此需要一次或多次**旋转**来重新平衡这棵树。
   - **右旋**：插入的元素在**平衡因子大于1的节点**的**左侧的左侧**（LL）。如下图所示，以Tn表示一棵子树，其中y节点的平衡因子大于1：
      ```
                 y
                / \     x.right=y 
               x   T4   y.left=T3          x
              / \          右旋           /  \
             z   T3        ===>         z     y
            / \                        / \   / \
           T1  T2                     T1 T2 T3  T4
      ```
   - **左旋**：插入的元素在**平衡因子小于-1的节点**的**右侧的右侧**（RR）。如下图所示，其中y节点的平衡因子小于-1：
      ```
                y
               / \          x.left=y 
              T4  x         y.right=T3        x
                 / \          左旋           /  \
                T3  z         ===>         y     z
                   / \                    / \   / \
                  T1  T2                 T4 T3 T1  T2
      ```
   - **先左旋再右旋**：插入的元素在**平衡因子大于1的节点**的**左侧的右侧**（LR）。如下图所示，其中y节点的平衡因子大于1：
     ```
                y                         y
               / \                       / \
              x   T4    先对x左旋，       z   T4                  z
             / \        转化为LL        / \        对y右旋       /  \
            T1  z         ===>        x  T3        ===>      x      y
               / \                   / \                    / \    / \
              T2  T3                T1  T2                 T1  T2 T3  T4
     ```
   - **先右旋再左旋**：插入的元素在**平衡因子小于-1的节点**的**右侧的左侧**（RL）。如下图所示，其中y节点的平衡因子小于-1：
     ```
               y                         y
              / \                       / \
             T1  x      先对x右旋，      T1  z                     z
                / \     转化为RR           / \      对y左旋       /  \
               z   T4     ===>           T2  x     ===>        y    x
              / \                           / \               / \   / \
             T2  T3                        T3  T4            T1  T2 T3 T4
     ```